<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convertisseur Pro</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <div class="main-wrapper">
        <header>
            <h1>Agentic <span class="accent">Converter</span></h1>
            <p>Traitement par lots ‚Ä¢ Compression avanc√©e ‚Ä¢ Multiformat</p>
        </header>

        <div class="app-container">

            <!-- Left Panel: Configuration -->
            <aside class="config-panel">
                <div class="tabs">
                    <button class="tab active" data-action="convert">Convertir</button>
                    <button class="tab" data-action="compress">Compresser</button>
                </div>

                <div id="settings-area">

                    <!-- CONVERT MODE: Category -> Format Selection -->
                    <div id="convert-settings" class="settings-group">
                        <!-- Step 1: Category Selection -->
                        <div class="step-section">
                            <label>1. Type de m√©dia</label>
                            <div class="category-buttons">
                                <button class="cat-btn" data-category="video">üé¨ Vid√©o</button>
                                <button class="cat-btn" data-category="audio">üéµ Audio</button>
                                <button class="cat-btn" data-category="image">üñºÔ∏è Image</button>
                            </div>
                        </div>

                        <!-- Step 2: Format/Codec Selection -->
                        <div class="step-section" id="format-step">
                            <label>2. Format de sortie</label>
                            <select id="global-format-select">
                                <option value="" disabled selected>S√©lectionnez un type d'abord...</option>
                            </select>
                        </div>

                        <!-- GIF Settings (shown when GIF selected for video) -->
                        <div id="gif-settings" class="settings-group hidden">
                            <h4>Param√®tres GIF</h4>
                            <div class="input-row">
                                <div class="input-group">
                                    <label>Vitesse</label>
                                    <select id="gif-speed">
                                        <option value="1.0">Normal (1x)</option>
                                        <option value="0.5">2x plus rapide</option>
                                        <option value="0.25">4x plus rapide</option>
                                        <option value="0.1" selected>10x plus rapide</option>
                                        <option value="2.0">2x plus lent</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label>Framerate (FPS)</label>
                                    <select id="gif-fps">
                                        <option value="10">10</option>
                                        <option value="15">15</option>
                                        <option value="20" selected>20</option>
                                        <option value="24">24</option>
                                        <option value="30">30</option>
                                    </select>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>R√©solution</label>
                                <select id="gif-resolution">
                                    <option value="1080">1080p</option>
                                    <option value="720">720p</option>
                                    <option value="480" selected>480p</option>
                                    <option value="360">360p</option>
                                    <option value="240">240p</option>
                                </select>
                            </div>
                        </div>

                        <!-- Image Quality Settings (shown when image category selected) -->
                        <div id="image-quality-settings" class="settings-group hidden">
                            <h4>Qualit√© Image</h4>
                            <div class="input-group">
                                <label>Qualit√©</label>
                                <select id="image-quality">
                                    <option value="lossless">üîí Sans perte (Lossless)</option>
                                    <option value="95">95% (Tr√®s haute)</option>
                                    <option value="90" selected>90% (Haute)</option>
                                    <option value="80">80% (Bonne)</option>
                                    <option value="70">70% (Moyenne)</option>
                                    <option value="60">60% (√âconomique)</option>
                                    <option value="50">50% (Compress√©e)</option>
                                </select>
                            </div>
                            <p class="settings-note">üí° La transparence est pr√©serv√©e automatiquement (PNG, WebP)</p>

                            <div class="input-row">
                                <div class="input-group">
                                    <label>R√©solution</label>
                                    <select id="image-res-select">
                                        <option value="original" selected>Originale (aucun redimensionnement)</option>
                                        <option value="3840">4K (3840 px)</option>
                                        <option value="2560">QHD (2560 px)</option>
                                        <option value="1920">1080p (1920 px)</option>
                                        <option value="1440">1440 px</option>
                                        <option value="1280">1280 px</option>
                                        <option value="1080">1080 px</option>
                                        <option value="720">720 px</option>
                                        <option value="480">480 px</option>
                                        <option value="360">360 px</option>
                                        <option value="256">256 px (favicon)</option>
                                        <option value="custom">Custom</option>
                                    </select>
                                </div>
                                <div class="input-group hidden" id="image-res-custom-wrapper">
                                    <label>Custom (max c√¥t√©)</label>
                                    <input type="number" id="image-res-custom" placeholder="Ex: 2048" min="16" max="8000">
                                </div>
                            </div>

                            <div id="ico-settings" class="settings-group hidden">
                                <h4>Options ICO / Favicon</h4>
                                <div class="input-row">
                                    <div class="input-group">
                                        <label>Taille cible</label>
                                        <select id="ico-size-select">
                                            <option value="256" selected>256 px (recommand√©)</option>
                                            <option value="128">128 px</option>
                                            <option value="64">64 px</option>
                                            <option value="48">48 px</option>
                                            <option value="32">32 px</option>
                                            <option value="24">24 px</option>
                                            <option value="16">16 px</option>
                                            <option value="original">Original (cap√© √† 256 px)</option>
                                            <option value="custom">Custom</option>
                                        </select>
                                    </div>
                                    <div class="input-group hidden" id="ico-custom-wrapper">
                                        <label>Custom</label>
                                        <input type="number" id="ico-custom-size" placeholder="16-256" min="16" max="256">
                                    </div>
                                </div>
                                <p class="settings-note">Limite ICO: 256 px max. L'image est conserv√©e au format carr√© sans l'agrandir.</p>
                            </div>
                        </div>
                    </div>

                    <!-- COMPRESS MODE: Full compression options -->
                    <div id="compress-settings" class="settings-group hidden">
                        <label>Mode de compression</label>

                        <div class="radio-group">
                            <label>
                                <input type="radio" name="comp-mode" value="crf" checked>
                                <span>Qualit√© (Standard)</span>
                            </label>
                            <label>
                                <input type="radio" name="comp-mode" value="size">
                                <span>Taille Cible (MB)</span>
                            </label>
                            <label>
                                <input type="radio" name="comp-mode" value="percent">
                                <span>R√©duction (%)</span>
                            </label>
                            <label>
                                <input type="radio" name="comp-mode" value="res">
                                <span>R√©solution</span>
                            </label>
                        </div>

                        <!-- Dynamic Input Area -->
                        <div id="comp-input-area" class="input-dynamic">
                            <!-- Default CRF Slider -->
                            <div id="input-crf">
                                <input type="range" id="crf-slider" min="1" max="3" value="2">
                                <div class="range-labels">
                                    <span>Faible</span><span>Moyen</span><span>Forte</span>
                                </div>
                            </div>

                            <!-- Size Input -->
                            <div id="input-size" class="hidden">
                                <input type="number" id="target-size" placeholder="Ex: 50" min="1">
                                <span class="unit">MB</span>
                            </div>

                            <!-- Percent Input -->
                            <div id="input-percent" class="hidden">
                                <input type="range" id="percent-slider" min="10" max="90" value="50">
                                <div class="value-display"><span id="percent-val">50</span>% de r√©duction</div>
                            </div>

                            <!-- Resolution Select -->
                            <div id="input-res" class="hidden">
                                <select id="res-select">
                                    <option value="1080">1080p (FHD)</option>
                                    <option value="720">720p (HD)</option>
                                    <option value="480">480p (SD)</option>
                                    <option value="360">360p (Low)</option>
                                </select>
                            </div>
                        </div>

                        <!-- Advanced Toggle for Compress Mode -->
                        <div class="advanced-toggle-wrapper">
                            <label class="switch">
                                <input type="checkbox" id="advanced-toggle">
                                <span class="slider round"></span>
                            </label>
                            <span class="toggle-label">Options Avanc√©es</span>
                        </div>

                        <!-- Advanced Settings Panel (only for compress) -->
                        <div id="advanced-settings" class="settings-group hidden">
                            <h4>Param√®tres Avanc√©s</h4>

                            <div class="input-row">
                                <div class="input-group">
                                    <label>Framerate (FPS)</label>
                                    <select id="adv-fps">
                                        <option value="">Original</option>
                                        <option value="24">24</option>
                                        <option value="30">30</option>
                                        <option value="60">60</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label>Preset Encodage</label>
                                    <select id="adv-preset">
                                        <option value="medium">Medium (D√©faut)</option>
                                        <option value="ultrafast">Ultrafast (Rapide)</option>
                                        <option value="fast">Fast</option>
                                        <option value="slow">Slow</option>
                                        <option value="veryslow">Very Slow (Compact)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="input-row">
                                <div class="input-group">
                                    <label>Audio Bitrate</label>
                                    <select id="adv-audio-bitrate">
                                        <option value="">Original</option>
                                        <option value="64k">64k</option>
                                        <option value="128k">128k</option>
                                        <option value="192k">192k</option>
                                        <option value="320k">320k</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label>Audio Channels</label>
                                    <select id="adv-audio-channels">
                                        <option value="">Original</option>
                                        <option value="1">Mono</option>
                                        <option value="2">Stereo</option>
                                    </select>
                                </div>
                            </div>

                            <div class="input-group">
                                <label>Sample Rate (Hz)</label>
                                <select id="adv-audio-rate">
                                    <option value="">Original</option>
                                    <option value="44100">44100</option>
                                    <option value="48000">48000</option>
                                </select>
                            </div>
                        </div>

                        <div id="compress-image-options" class="settings-group">
                            <h4>Options Image</h4>
                            <div class="input-row">
                                <div class="input-group">
                                    <label>R√©solution</label>
                                    <select id="compress-image-res-select">
                                        <option value="original" selected>Originale (aucun redimensionnement)</option>
                                        <option value="3840">4K (3840 px)</option>
                                        <option value="2560">QHD (2560 px)</option>
                                        <option value="1920">1080p (1920 px)</option>
                                        <option value="1440">1440 px</option>
                                        <option value="1280">1280 px</option>
                                        <option value="1080">1080 px</option>
                                        <option value="720">720 px</option>
                                        <option value="480">480 px</option>
                                        <option value="360">360 px</option>
                                        <option value="256">256 px (favicon)</option>
                                        <option value="custom">Custom</option>
                                    </select>
                                </div>
                                <div class="input-group hidden" id="compress-image-res-custom-wrapper">
                                    <label>Custom (max c√¥t√©)</label>
                                    <input type="number" id="compress-image-res-custom" placeholder="Ex: 2048" min="16" max="8000">
                                </div>
                            </div>
                            <p class="settings-note">S'applique uniquement aux images. Aucun redimensionnement si "Originale".</p>
                        </div>
                    </div>
                </div>

                <button id="start-btn" class="primary-btn" disabled>
                    Lancer le traitement
                </button>
            </aside>

            <!-- Right Panel: File Queue -->
            <main class="queue-panel">
                <div class="upload-zone" id="drop-zone">
                    <div class="icon">üìÅ</div>
                    <h3>Glisser-d√©poser vos fichiers ici</h3>
                    <p>ou cliquez pour parcourir (Illimit√©)</p>
                    <input type="file" id="file-input" multiple hidden>
                </div>

                <div class="file-list-header">
                    <h3>File d'attente <span id="file-count">(0)</span></h3>
                    <div class="header-actions">
                        <button id="download-all-btn" class="text-btn" disabled>üì¶ Tout t√©l√©charger</button>
                        <button id="clear-btn" class="text-btn danger">üóëÔ∏è Tout effacer</button>
                    </div>
                </div>

                <div id="file-list" class="file-list">
                    <!-- File Items will be injected here -->
                    <div class="empty-state">Aucun fichier en attente</div>
                </div>
            </main>

        </div>
    </div>

    <!-- Template for a file item with thumbnail -->
    <template id="file-item-template">
        <div class="file-item">
            <div class="file-thumb">
                <img class="thumb-img" src="" alt="">
                <div class="thumb-placeholder">üìÑ</div>
            </div>
            <div class="file-info">
                <div class="file-name">nom_du_fichier.mp4</div>
                <div class="file-meta">15.4 MB ‚Ä¢ En attente</div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill"></div>
                </div>
            </div>
            <div class="file-actions">
                <button class="remove-btn" type="button">‚úï</button>
                <a href="#" class="download-btn hidden">‚¨á</a>
            </div>
        </div>
    </template>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>
